Map Rendering:

- Improve grid drawing in minimap?
- There are still some black artifacts sometimes. It seems this is only true for one tile type (grass) and one slope type (a triangle pointing down right).
  It is not affected by zoom or map scrolling so I guess it is a problem with the graphic/shader/index/mask itself. Maybe a mismatch in graphic and mask index.


Non-working code:

- Map clicks are not always at the right spot/tile (I guess this is caused by tile heights)
	- This also hinders road building sometimes
- Minimap clicks near the map origin move to wrong x location
- Possible builds contain not all possible building locations (e.g. for the castle)


AI:

Flags / buildings / roads:
- Linking flags should also allow for merging paths
- Sometimes a building is build in a spot where the flag could not be linked and burned down afterwards (multiple times). This was fixed but it seems that it does still occur.
- AIs with much resources build so much buildings at a time that no one is finished in a reasonable time. Maybe limit the number of constructed buildings. This will also relax traffic a bit.
- AIs that prefer farms seem to build unlimited (at least way too much) farms.
- First stock is build too early
- Buildings military buildings is either to slow for expansion or not well placed. In any case the territory is too full most of the time.

Misc:  
- Maybe smart AIs should hold enough planks to rebuild a destroyed sawmill and lumberjack.
	- This is only necessary if an enemy is near enough.
- After hard times start the game time is very high so AI decisions depending on game time seem strange then (e.g. building many farms at once).
- With much starting supplies the AIs (even smart ones) build their castle in locations without stone.
- New lumberjacks/foresters are build way too fast (especially the third one)

Mining / finding minerals:
- Finding minerals and mine spots is not good yet. The search spots should change from time to time but changing doesn't mean putting hundreds of flags at the same mountain.
- In hard times the search for mountains should be better (look specific for coal and iron spots).
- Flags for geologists are too far away from mountains.
- Looking for mineral spots and actually building mines should be two separate steps (there are already but at the moment the FindOre state also builds the mine).
- Sometimes there are way too many geologist out there. This also causes traffic. It seems that every single hammer is used to train a geologist.

Some AI values are lost when saving/loading games!
Finish attacking logic!


Performance:

- While debugging the game pauses from time to time (more game time = longer and more pauses). The game is unplayable very quick.


Bugs:

- When loading a savegame, playing it and close it afterwards without saving, it seems that the game is saved again at closing automatically somehow. The savegame was changed.


Logic:

- If a flag is full of resources and the transporters too, they won't exchange the resources at the flag and so there is a deadlock.
- A transporter first walks to the last flag and then goes back to the beginning of the road to goto idle mode.
  - I think in original game the transporter went straight to idle mode when he was at the right location.
  - Is this maybe caused by wrong road building direction? This is often seen in AIs. Maybe the linking of roads is reversed there?!
- Geologists give up too fast.
- Once a freewalking lumberjack blocks a road and stand there waiting. Also seen a forester. He was not even on the road but tried to walk towards it. The transporter on the road
  was also blocked by this.
- Sometimes there is a deadlock of walking serfs. Saw a digger and a transporter that were waiting at each other but could just switch positions.
  - In debug there were two diggers (one with state WaitIdleOnPath and one with Walking). A digger should never have WaitIdleOnPath I think as this is for transporters only!
- Sometimes construction materials are not moved out of the castle. The construction site gets no resources. After demolishing/rebuilding it works again.
  This also happens if the building was already built a bit. And it seems to happen quite often lately.
  - Since a change in update logic this seem to be fixed. Further testing needed.
  - Sometimes resources are no longer delivered to a construction site even if there are enough in the castle
	- I guess this happens when the emergency program gets active at a specific time.
	- The workaround was building.RemoveRequestedMaterials(); in Player.UpdateEmergencyProgram. But this can lead to an exception in Building.RequestedResourceDelivered.


Notification Box:

Bad display of text/image.
Test again because font char gaps should be smaller now!

- Text too long for:
	FoundStone
    MineEmpty
    OneHourSinceSave
    UnderAttack
- Chaos for:
    LostBuildings


Missing stuff:

- spectators must be able to view all players (building stocks etc) or must be able to select a player
	- building stocks works now but the statistics and settings are only for player 1
- multiplayer
	- multiplayer should support coop mode (one player is played by two or more clients)
- button to merge roads to a flag
- mine elevator/miner animation
- ground analysis for local spectators?


Nice to have:

- After closing a game the GameInitBox should display the last started game settings.
  This way a map can be played again or the RNG number can be memorized.


TODO:

- Check/improve map position selection (clicks, minimap clicks, centering)
- Finish AIs
- Finish rendering of fighting serfs (additional serf stuff)
- Finish rendering of all additional stuff for all buildings (only mine elevator drawing is not perfect yet)
- Add more game options (like tutorial)
- Improve/fix sound and add music/sound players for all operating systems
- Look through all TODO code comments and resolve them
- Bugfixing (important is the serf logic which seems to be very bugged in some situations)
- Remove unused code and improve bad code
- Adjust and limit all values properly (like max speed increase and so on)
- Check if all shortcuts/keystrokes work as expected (if not implement them)
- Add new features / improve usability (more infos in UI, better menus, indicators like "how many trees are left for a lumberjack" or even a visual search area if the building is selected, get materials after demolishing)
- Localization (texts should be of the right language later)
- Rework whole serf, flag and path logic. Flag searches should be eased by the stored road instances of each flag.
- Feature to record a game and replay/watch it (like watching an AIvsAI game)
- Crash handler:
	- Should try to continue without crashing
- End game screens, Intro, Outro, etc


Exceptions:

- When a knight wins a fight there is often a bad torso sprite index
- If not debugging there is sometimes an exception in PopupBox.DrawResourceDirectionBox ("Not a knight among the castle defenders.")
  - Not seen for a long time. Maybe only when setting the castle knights manually?
- Target array is too small
- Delivered unexpected resource
- KeyNotFoundException (maybe when knights fight)