Map Rendering:

- Improve grid drawing in minimap?
- There are still some black artifacts sometimes. It seems this is only true for one tile type (grass) and one slope type (a triangle pointing down right).
  It is not affected by zoom or map scrolling so I guess it is a problem with the graphic/shader/index/mask itself. Maybe a mismatch in graphic and mask index.
- Since recently (I guess since the fix to map object positioning in the middle of january of 2019) there are map jumps again at some scroll positions.
  Also the minimap click re-location of the map is not working correctly anymore in all cases. And I saw missing render map objects at some scroll positions.
  And sometimes the "show possible builds" only is displayed for half of the map. Also the map cursor has the same issue. Building seem to work though in some of these places.


Serf rendering:


Non-working code:

- Sometimes a road can not be build in a direction where it should be possible (maybe this is due to wrong map position calculation)
- Map clicks are not always considered or at the right spot/tile
- Sometimes road building is strange. No road is built in direction but then 2-3 at once.
- Minimap clicks are only sometimes right (at least the map movement)
- Sometimes the player color indicator in AI vs AI is drawn strangly over the panel bar.
- Sometimes resources are no longer delivered to a construction site even if there are enough in the castle
	- I guess this happens when the emergency program gets active at a specific time.
	- The workaround was building.RemoveRequestedMaterials(); in Player.UpdateEmergencyProgram. But this can lead to an exception in Building.RequestedResourceDelivered.
- When closing and re-open the toolmaker priority popup, the values can't be changed. After "set defaults" it works again. Maybe this is also true for other slidebars?!


AI:

- Linking flags should also allow for merging paths
- Finding minerals and mine spots is not good yet. The search spots should change from time to time but
  changing doesn't mean putting hundreds of flags at the same mountain.
- Maybe smart AIs should hold enough planks to rebuild a destroyed sawmill and lumberjack.
	- This is only necessary if an enemy is near enough.
- In hard times the search for mountains should be better (look specific for coal and iron spots and with increased search range -> huts must be on point!)
- In hard times the fisher is sometimes built too far away from the water.
- Road building may be bad in later game. There might be large road systems that are fully independent of others so a serf has to walk for ages to get there.
- After hard times end the AI builds huts without having knights. Should not happen.
- After hard times start the game time is very high so AI decisions depending on game time seem strange then (e.g. building many farms at once).


Logic:

- With increased game speed the AI is much faster than the game (e.g. buildings and roads are already built before the first serf leaves the castle).
  Maybe the long tick time at the start will not notice the game speed increase and therefore wait long for the next update cycle. This seems right as the game will then run smoothly.
- If a flag is full of resources and the transporters too, they won't exchange the resources at the flag and so there is a deadlock.
- A transporter first walks to the last flag and then goes back to the beginning of the road to goto idle mode.
  - I think in original game the transporter went straight to idle mode when he was at the right location.
  - Is this maybe caused by wrong road building direction? This is often seen in AIs. Maybe the linking of roads is reversed there?!
- Not sure if the "towards" logic in Map class works correctly yet.
- Geologists give up too fast.
- Once a freewalking lumberjack blockes a road and stand there waiting.
- Sometimes there is a deadlock of walking serfs. Saw a digger and a transporter that were waiting at each other but could just switch positions.
  - In debug there were two diggers (one with state WaitIdleOnPath and one with Walking). A digger should never have WaitIdleOnPath I think as this is for transporters only!


Notification Box:

Test again because font char gaps should be smaller now!

- Text too long for:
	FoundStone
    MineEmpty
    OneHourSinceSave
    UnderAttack
- Chaos for:
    LostBuildings


Missing stuff:

- bird sounds
- spectators must be able to view all players (building stocks etc) or must be able to select a player
	- building stocks works now but the statistics and settings are only for player 1
- multiplayer
	- multiplayer should support coop mode (one player is played by two or more clients)
- button to merge roads to a flag
- mine elevator/miner animation


Nice to have:

- After closing a game the GameInitBox should display the last started game settings.
  This way a map can be played again or the RNG number can be memorized.


TODO:

- Finish game saving/loading
- Check/improve map position selection (clicks, minimap clicks, centering)
- Finish AIs
- Finish rendering of fighting serfs (additional serf stuff)
- Finish rendering of all additional stuff for all buildings (only mine elevator drawing is not perfect yet)
- Add more game options (like tutorial)
- Improve/fix sound
- Look through all TODO code comments and resolve them
- Bugfixing (important is the serf logic which seems to be very bugged in some situations)
- Remove unused code and improve bad code
- Adjust and limit all values properly (like max speed increase and so on)
- Check if all shortcuts/keystrokes work as expected (if not implement them)
- Add new features / improve usability (more infos in UI, better menus, indicators like "how many trees are left for a lumberjack" or even a visual search area if the building is selected, get materials after demolishing)
- Localization (texts should be of the right language later)
- Rework whole serf, flag and path logic. Flag searches should be eased by the stored road instances of each flag.


Exceptions:

- When a knight wins a fight there is often a bad torso sprite index
- If not debugging there is sometimes an exception in PopupBox.DrawResourceDirectionBox ("Not a knight among the castle defenders.")